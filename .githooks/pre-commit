#!/usr/bin/env bash
set -euo pipefail

staged_files="$(git diff --cached --name-only)"

if [[ -z "${staged_files}" ]]; then
  exit 0
fi

blocked='^(node_modules/|dist/|coverage/|\.turbo/|\.pnpm-store/)'
if echo "${staged_files}" | rg -q "${blocked}"; then
  echo "❌ Commit blocked: staged files include generated/dependency content."
  echo "   Remove these paths from staging: node_modules/, dist/, coverage/, .turbo/, .pnpm-store/."
  exit 1
fi

echo "✅ pre-commit: repository hygiene checks passed"
